<?php

/**
 * ReservationTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class ReservationTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object ReservationTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('Reservation');
    }
    
    public function getAllReservation()
    {
      	$q = $this->createQuery('q');
            
         return $q;
    }
    
    public function getReservationById($id)
    {
		
        $q = $this->createQuery('q')
	    		->where('q.id = ?', $id)
            ->addOrderBy('date');
        /*
        $q = Doctrine_Query::create()
        		->select('*')
        		->from('Reservation r, SfGuardUser u')
        		//->from('Reservation r')
        		->where('r.id = ?', $id)
        		->andWhere('r.id_user_reserve=u.id')
        		//->leftJoin('r.UserReserve u')
        		->addOrderBy('date');
        	*/
        	
         return $q;
    }
    
    public function getReservationBySalle($salle)
    {
        $q = $this->createQuery('a')
	    ->where('a.id_salle = ?', $salle)
            ->addOrderBy('a.date');
            
         return $q;
    }
    
    public function isReservationNoValidExist($id)
    {
    		$q = $this->createQuery()
	    		->where('id = ?', $id)
            ->andWhere('estValide=?', 0)->execute();
            
         return (count($q) > 0);
    
    }
  
  public function getReservationNoValide()
  {
  		$q = $this->createQuery('a')
  				->where('a.estValide=?', 0)
  				->addOrderBy('a.date','ASC');
  				
  		return $q;
  }




}
